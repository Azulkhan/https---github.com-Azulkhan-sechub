using System;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

class Program
{
    [DllImport("User32.dll")]
    public static extern bool SetForegroundWindow(IntPtr hWnd);

    [DllImport("User32.dll")]
    public static extern IntPtr GetForegroundWindow();

    static void Main()
    {
        Console.WriteLine("Автопечать начнется через 5 секунд...");
        Thread.Sleep(5000);  // Ожидание 5 секунд перед началом

        while (true)
        {
            IntPtr currentWindow = GetForegroundWindow();  // Получаем текущее активное окно
            SetForegroundWindow(currentWindow);  // Делаем его активным для ввода

            SendKeys.Send("Hello!");  // Отправляем текст "Hello!"
            SendKeys.Send("{ENTER}"); // Нажимаем Enter после текста

            Thread.Sleep(60000);  // Ждем 60 секунд перед следующей отправкой
        }
    }
}