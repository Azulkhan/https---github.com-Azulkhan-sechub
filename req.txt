
CREATE PROCEDURE GetHierarchicalData
AS
BEGIN
    WITH RecursiveCTE AS (
        SELECT ID, ParentID, Name, URL
        FROM YourTable
        WHERE ParentID IS NULL -- Выбираем корневые элементы
        UNION ALL
        SELECT t.ID, t.ParentID, t.Name, t.URL
        FROM YourTable t
        INNER JOIN RecursiveCTE r ON t.ParentID = r.ID -- Рекурсивно выбираем дочерние элементы
    )
    SELECT ID, ParentID, Name, URL
    FROM RecursiveCTE
    ORDER BY ID; -- Можно выбирать и сортировать данные по необходимому полю
END;


using System.Collections;
using System.Web.UI;

namespace YourNamespace
{
    public class YourDataSourceClass : IHierarchicalDataSource
    {
        // Реализация методов интерфейса IHierarchicalDataSource
        // ...
    }
}
