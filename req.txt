Если вам нужно просто прикрепить файл к REST-запросу и отправить его по почте, то для работы с файлами в REST сервисе (например, через API для отправки почты) вам нужно подготовить файл в правильном формате, например, как часть multipart/form-data.

Вот базовый пример Lua-кода для отправки REST-запроса с прикрепленным файлом:

```lua
local http = require("socket.http")
local ltn12 = require("ltn12")
local mime = require("mime")

-- Массив с файлами
files = {}

-- Пример добавления файла в массив (без чтения, просто описание)
table.insert(files, {name = "test.txt", path = "/path/to/test.txt", type = "text/plain"})

-- Функция для отправки файла по почте
function sendFileViaEmail(files)
    local boundary = "----WebKitFormBoundary7MA4YWxkTrZu0gW"  -- произвольная граница для multipart данных

    -- Создаем тело запроса
    local body = "--" .. boundary .. "\r\n"
    body = body .. 'Content-Disposition: form-data; name="file"; filename="' .. files[1].name .. '"\r\n'
    body = body .. "Content-Type: " .. files[1].type .. "\r\n\r\n"
    body = body .. mime.b64("path/to/" .. files[1].path) .. "\r\n" -- кодируем файл в base64

    body = body .. "--" .. boundary .. "--\r\n"

    -- Заголовки запроса
    local headers = {
        ["Content-Type"] = "multipart/form-data; boundary=" .. boundary,
        ["Content-Length"] = #body
    }

    -- Отправляем запрос
    local response_body = {}
    local res, code, response_headers = http.request{
        url = "https://api.emailservice.com/send",
        method = "POST",
        headers = headers,
        source = ltn12.source.string(body),
        sink = ltn12.sink.table(response_body)
    }

    -- Проверка результата
    if code == 200 then
        print("Файл успешно отправлен по почте")
    else
        print("Ошибка при отправке почты: " .. code)
    end
end

-- Вызываем функцию
sendFileViaEmail(files)
```

Этот пример показывает отправку файла через REST-запрос с использованием multipart/form-data. Конечно, API для почтовой отправки может отличаться в зависимости от вашей системы (например, DAMU CRM), поэтому нужно будет адаптировать его под конкретный формат данных.

Убедитесь, что API почтового сервиса поддерживает отправку файлов как части REST-запроса.