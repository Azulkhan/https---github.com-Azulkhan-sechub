WITH RECURSIVE working_days AS (
    -- Начальная дата
    SELECT start_date AS date
    FROM (SELECT '2024-10-01 00:00:00'::timestamp AS start_date) AS params

    UNION ALL

    -- Генерация следующих дней
    SELECT date + INTERVAL '1 day'
    FROM working_days
    WHERE date < '2025-01-01'::timestamp -- Ограничение, чтобы не генерировать слишком много дней
),
filtered_days AS (
    SELECT date,
           ROW_NUMBER() OVER (ORDER BY date) AS rn
    FROM working_days
    WHERE EXTRACT(DOW FROM date) NOT IN (0, 6) -- Исключаем выходные (воскресенье и субботу)
)
SELECT date
FROM filtered_days
WHERE rn % 6 = 0 -- Получаем все шестые рабочие дни
ORDER BY date;