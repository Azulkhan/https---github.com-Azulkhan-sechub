local function execute_command(command)
    local handle = io.popen(command)
    local result = handle:read("*a")
    handle:close()
    return result
end

-- Путь к вашему файлу сертификата
local certPathCER = "/path/to/your/certificate.cer"

-- Команда для просмотра информации о сертификате
local tempFilePath = os.tmpname()
local openssl_command = string.format("openssl x509 -in %s -inform der -text -noout > %s", certPathCER, tempFilePath)
local view_result = execute_command(openssl_command)

-- Чтение и вывод содержимого временного файла
local tempFile = io.open(tempFilePath, "r")
if tempFile then
    local content = tempFile:read("*a")
    tempFile:close()

    -- Извлечение информации о субъекте (фамилия, имя и т.д.)
    local subject_info = content:match("Subject:%s*(.-)\n")
    if subject_info then
        print("Subject Information:\n", subject_info)
    else
        print("Subject information not found.")
    end
else
    print("Failed to read temporary file:", tempFilePath)
end

-- Удаление временного файла
os.remove(tempFilePath)
