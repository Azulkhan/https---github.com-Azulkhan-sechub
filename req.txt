Понял, вы хотите добавить объединенные заголовки в ваш текущий формат. Вот как это можно сделать:

1. Создать объединенные заголовки и добавить их в массив данных `createxlsxformat`.
2. Объединить ячейки заголовков.

Вот пример кода, который выполняет эти шаги:

```javascript
// Подключаем библиотеку xlsx
const XLSX = require('xlsx');

// Ваши заголовки
let xlsHeader = ["Номер", "Класс", "Номер", "Класс"];

// Данные для Excel (пример данных)
let data = [
  [1, 'A', 2, 'B'],
  [3, 'C', 4, 'D']
];

// Создаем массив для хранения данных в формате xlsx
let createxlsxformat = [];

// Создаем объединенные заголовки
let mergedHeader = ["Общие данные", null, "Данные ПО факту", null];
createxlsxformat.push(mergedHeader); // Добавляем объединенные заголовки
createxlsxformat.push(xlsHeader); // Добавляем основные заголовки

// Добавляем данные в массив
data.forEach(row => createxlsxformat.push(row));

// Создаем рабочий лист из массива данных
let ws = XLSX.utils.aoa_to_sheet(createxlsxformat);

// Объединяем ячейки для заголовков
ws['!merges'] = [
  { s: { r: 0, c: 0 }, e: { r: 0, c: 1 } },  // Объединение ячеек "Общие данные"
  { s: { r: 0, c: 2 }, e: { r: 0, c: 3 } }   // Объединение ячеек "Данные ПО факту"
];

// Создаем новую книгу и добавляем в нее лист
let wb = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb, ws, "Sheet1");

// Сохраняем книгу в файл
XLSX.writeFile(wb, 'example.xlsx');
```

Объяснение:

1. **Определяем заголовки и данные**: Создаем массив `xlsHeader` для заголовков и `data` для данных.
2. **Создаем массив для хранения данных**: Создаем пустой массив `createxlsxformat`.
3. **Создаем и добавляем объединенные заголовки**: Создаем массив `mergedHeader` для объединенных заголовков и добавляем его в `createxlsxformat`.
4. **Добавляем основные заголовки и данные**: Добавляем `xlsHeader` и данные из `data` в `createxlsxformat`.
5. **Создаем рабочий лист**: Создаем рабочий лист из массива данных с помощью `XLSX.utils.aoa_to_sheet`.
6. **Объединяем ячейки заголовков**: Используем `ws['!merges']` для объединения ячеек заголовков.
7. **Создаем книгу и добавляем лист**: Создаем новую книгу и добавляем в нее рабочий лист.
8. **Сохраняем книгу в файл**: Сохраняем файл с названием `example.xlsx`.

Этот код добавляет объединенные заголовки к вашему текущему формату и сохраняет данные в файл Excel.