WITH RECURSIVE working_days AS (
    SELECT 
        '2024-10-01'::date AS date
    UNION ALL
    SELECT 
        date + INTERVAL '1 day'
    FROM 
        working_days
    WHERE 
        date < '2024-10-15'  -- Указываем конечную дату
),
filtered_working_days AS (
    SELECT 
        date
    FROM 
        working_days
    WHERE 
        EXTRACT(DOW FROM date) BETWEEN 1 AND 5  -- Рабочие дни (Пн-Пт)
),
numbered_days AS (
    SELECT 
        date,
        ROW_NUMBER() OVER (ORDER BY date) AS rn
    FROM 
        filtered_working_days
)
SELECT 
    date
FROM 
    numbered_days
WHERE 
    rn = (
        SELECT COUNT(*) 
        FROM numbered_days 
        WHERE date <= '2024-10-14'  -- Текущая дата
    ) + 6;  -- Находим следующий шестой рабочий день