WITH RECURSIVE working_days AS (
    -- Генерация всех рабочих дней между заданными датами
    SELECT date
    FROM generate_series(
        '2024-10-01'::timestamp, 
        '2024-10-30'::timestamp, 
        '1 day'::interval
    ) AS date
    WHERE EXTRACT(DOW FROM date) NOT IN (0, 6) -- Исключаем выходные (воскресенье и субботу)
),
sixth_days AS (
    SELECT date,
           ROW_NUMBER() OVER (ORDER BY date) AS rn
    FROM working_days
),
next_sixth_day AS (
    -- Находим следующий шестой рабочий день после указанной даты
    SELECT MIN(date) AS next_sixth_working_day
    FROM (
        SELECT date
        FROM sixth_days
        WHERE date > CURRENT_DATE -- Замените на нужную вам дату
    ) AS future_days
    WHERE (rn - 1) % 6 = 0
)
SELECT next_sixth_working_day
FROM next_sixth_day;