WITH RECURSIVE working_days AS (
    -- Генерация всех рабочих дней между заданными датами
    SELECT date
    FROM generate_series(
        '2024-10-01'::timestamp, 
        '2024-10-30'::timestamp, 
        '1 day'::interval
    ) AS date
    WHERE EXTRACT(DOW FROM date) NOT IN (0, 6) -- Исключаем выходные (воскресенье и субботу)
),
sixth_days AS (
    -- Находим шестые рабочие дни
    SELECT date,
           ROW_NUMBER() OVER (ORDER BY date) AS rn
    FROM working_days
)
SELECT date
FROM sixth_days
WHERE (rn - 1) % 6 = 0 -- Возвращаем только шестые рабочие дни
ORDER BY date;