Для создания Excel-файла с использованием HTML и добавления стилей, таких как заголовки и подзаголовки, можно использовать библиотеку `SheetJS` (xlsx) в JavaScript. Вот пример кода, который поможет вам начать:

1. **Подготовка HTML**:
    - Создайте HTML-таблицу с данными, которые вы хотите экспортировать в Excel.

```html
<!DOCTYPE html>
<html>
<head>
    <title>Export to Excel</title>
</head>
<body>
    <table id="data-table">
        <thead>
            <tr>
                <th colspan="2">Server Report</th>
            </tr>
            <tr>
                <th>Server</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Server 1</td>
                <td>Active</td>
            </tr>
            <tr>
                <td>Server 2</td>
                <td>Inactive</td>
            </tr>
            <!-- Add more rows as needed -->
        </tbody>
    </table>
    <button onclick="exportToExcel()">Export to Excel</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <script>
        function exportToExcel() {
            var wb = XLSX.utils.table_to_book(document.getElementById('data-table'), {sheet: "Sheet1"});
            
            // Применение стилей к заголовкам
            var ws = wb.Sheets["Sheet1"];
            var range = XLSX.utils.decode_range(ws['!ref']);
            
            for(var C = range.s.c; C <= range.e.c; ++C) {
                var cell = ws[XLSX.utils.encode_cell({r:1, c:C})]; // Second row (header)
                if(cell) {
                    cell.s = {
                        font: {
                            bold: true,
                            color: { rgb: "FFFFFF" }
                        },
                        fill: {
                            fgColor: { rgb: "4F81BD" }
                        }
                    };
                }
            }
            
            XLSX.writeFile(wb, 'report.xlsx');
        }
    </script>
</body>
</html>
```

2. **JavaScript**:
    - Сначала загружается библиотека `SheetJS`.
    - Затем, при нажатии кнопки "Export to Excel", таблица преобразуется в Excel.
    - Добавлены стили для заголовков (шрифт жирный и цветной фон).

Этот пример создает простую HTML-таблицу и экспортирует её в Excel с заголовками, стилизованными синим фоном и белым текстом. Вы можете дополнительно настраивать стили, добавляя или изменяя свойства в объекте `cell.s`.