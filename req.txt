WITH RECURSIVE working_days AS (
    -- Генерация всех рабочих дней между заданными датами
    SELECT date
    FROM generate_series(
        '2024-10-01'::timestamp, 
        '2024-10-30'::timestamp, 
        '1 day'::interval
    ) AS date
    WHERE EXTRACT(DOW FROM date) NOT IN (0, 6) -- Исключаем выходные (воскресенье и субботу)
),
sixth_days AS (
    SELECT date,
           ROW_NUMBER() OVER (ORDER BY date) AS rn
    FROM working_days
),
result AS (
    -- Начинаем с первого рабочего дня
    SELECT MIN(date) AS sixth_working_day
    FROM sixth_days
    WHERE rn = 1 -- Первый найденный рабочий день
    UNION ALL
    -- Рекурсивно находим каждый следующий шестой рабочий день
    SELECT date + INTERVAL '7 days' -- Добавляем 7 дней к последнему шестому рабочему дню
    FROM result
    WHERE date + INTERVAL '7 days' <= '2024-10-30'::timestamp -- Ограничение по конечной дате
)
SELECT date
FROM result
WHERE date IS NOT NULL
ORDER BY date;