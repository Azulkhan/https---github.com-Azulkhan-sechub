Чтобы сделать строку "итого" в PostgreSQL, можно использовать объединение основного запроса с запросом, который вычисляет итоговые значения. Вот пример, как это можно сделать:

```sql
WITH main_query AS (
    SELECT 
        column1,
        column2,
        SUM(column3) AS total
    FROM 
        your_table
    WHERE 
        %filter%
    GROUP BY 
        column1, column2
)
SELECT 
    column1,
    column2,
    total
FROM 
    main_query

UNION ALL

SELECT 
    'Итого' AS column1,
    NULL AS column2,
    SUM(total) AS total
FROM 
    main_query

ORDER BY 
    column1, column2;
```

В этом примере используется Common Table Expression (CTE) для основного запроса (`main_query`). Затем основной запрос объединяется с запросом, который вычисляет итоговые значения и добавляет строку "Итого". Если вам нужно использовать динамическое упорядочение, вы можете добавить его в основной запрос и запрос итогов.

Этот подход позволяет добавить строку "Итого" в результат вашего запроса без значительных изменений в структуре основного запроса.