
Чтобы найти первый рабочий день после окончания квартала с использованием SQL, потребуется создать таблицу с нерабочими днями (выходными и праздниками) и выполнить запрос с учетом этой таблицы. К сожалению, SQL не поддерживает напрямую вычисление дат без внешних данных о выходных и праздниках, так что логика запроса будет зависеть от вашей специфической базы данных и доступных таблиц.

Предположим, у нас есть таблица `holidays` со столбцом `holiday_date`, включающая все выходные и праздничные дни. Тогда запрос к базе данных может выглядеть примерно так:

```sql
WITH RECURSIVE DateSeries AS (
  SELECT '2024-04-01'::date AS check_date -- начальная дата для поиска первого рабочего дня после 1 квартала
  UNION
  SELECT check_date + INTERVAL '1 day'
  FROM DateSeries
  WHERE check_date < '2024-04-10' -- ограничиваем поиск ради производительности
)
SELECT MIN(check_date) AS first_working_day_after_q1
FROM DateSeries
WHERE check_date NOT IN (SELECT holiday_date FROM holidays)
AND EXTRACT(ISODOW FROM check_date) < 6; -- исключаем выходные (субботу и воскресенье)
```

Этот запрос:

1. Создает рекурсивный временный набор данных `DateSeries`, который содержит даты начиная с '2024-04-01' (первый день после окончания первого квартала) и продолжается вперед по дням.
2. Затем ищет минимальную дату (`MIN(check_date)`), которая не является выходным или праздничным днем.
3. Использование `EXTRACT(ISODOW FROM check_date) < 6` исключает субботу и воскресенье (предполагая, что нумерация дней недели начинается с 1 для понедельника и заканчивается 7 для воскресенья).

Обратите внимание, что этот запрос примерный и может потребовать адаптации под вашу конкретную СУБД и формат дат. Также он предполагает, что у вас есть таблица `holidays` с праздничными датами.
