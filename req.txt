WITH RECURSIVE working_days AS (
    -- Генерация всех рабочих дней между заданными датами
    SELECT date
    FROM generate_series(
        '2024-10-01'::timestamp, 
        '2024-10-30'::timestamp, 
        '1 day'::interval
    ) AS date
    WHERE EXTRACT(DOW FROM date) NOT IN (0, 6) -- Исключаем выходные (воскресенье и субботу)
),
sixth_days AS (
    -- Нумеруем рабочие дни
    SELECT date,
           ROW_NUMBER() OVER (ORDER BY date) AS rn
    FROM working_days
),
result AS (
    -- Начинаем с первого найденного рабочего дня
    SELECT date
    FROM sixth_days
    WHERE rn = 1 -- Первый найденный рабочий день

    UNION ALL

    -- Рекурсивно находим каждый следующий шестой рабочий день
    SELECT sd.date
    FROM sixth_days sd
    JOIN result r ON sd.rn = r.rn + 6 -- Добавляем 6 к номеру текущего рабочего дня
)
SELECT date
FROM result
ORDER BY date;