Для извлечения сертификатов с помощью `openssl x509` и записи их в текстовый файл с использованием Lua, вам понадобится скрипт, который выполнит необходимые команды и обработает результаты. Вот пример такого скрипта:

1. Создайте Lua скрипт, который выполнит команду `openssl x509` и запишет результат в файл:

```lua
-- Имя файла сертификата
local cert_file = "cert.pem"
-- Имя файла для сохранения сертификатов
local output_file = "certs.txt"

-- Функция для выполнения команды и получения результата
local function execute_command(cmd)
    local handle = io.popen(cmd)
    local result = handle:read("*a")
    handle:close()
    return result
end

-- Команда для получения сертификатов
local command = "openssl x509 -in " .. cert_file .. " -text -noout"

-- Выполнение команды и получение сертификатов
local certs = execute_command(command)

-- Запись сертификатов в файл
local file = io.open(output_file, "w")
file:write(certs)
file:close()

print("Сертификаты сохранены в файл " .. output_file)
```

2. Убедитесь, что у вас установлен `openssl` и сертификат доступен по пути, указанному в `cert_file`.

3. Запустите Lua скрипт:

```sh
lua ваш_скрипт.lua
```

Этот скрипт выполнит команду `openssl x509`, извлечет информацию о сертификате и запишет ее в указанный текстовый файл. Если вам нужно работать с несколькими сертификатами, можно доработать скрипт, чтобы он обрабатывал их по списку.